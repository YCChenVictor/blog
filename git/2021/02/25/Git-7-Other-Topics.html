<!DOCTYPE html>
<html lang="en-US">
  <head>
    <!-- 3D drawing -->
    
    <!-- 2D drawing -->
    
    <!-- for mathjax support -->
    
    <!-- mermaid --><meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="/blog/assets/css/main.css">
    <script src="https://kit.fontawesome.com/f9271f6bdd.js" crossorigin="anonymous"></script>
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/github-dark-dimmed.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
  </head>

  <body class="font-mono list-disc">
    <div class="pt-12 pb-4">
      
        <nav class="flex flex-wrap items-center justify-center px-2 mb-6">
  <div class="container px-4 mx-auto flex flex-wrap items-center justify-center">
    <div class="w-full relative flex justify-center">
      <button type="button" onclick="toggleNavbar('navbar')"
        class="rounded-md inline-flex items-center justify-center text-gray-500 md:hidden"
        aria-expanded="false">
        <span class="sr-only">Open menu</span>
        <!-- Heroicon name: outline/menu -->
        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
          stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>

    <div class="flex hidden md:block" id="navbar">
      <div class="flex flex-col md:flex-row mr-auto w-full">
         <!-- don't show Home in menu for Homepage -->
        <a class="text-sm text-gray-500 hover:text-gray-900 px-3 py-2 lg:py-1 mx-auto uppercase"
          href="/blog/">
          Home
        </a>
        

      <!-- dynamic menu based on navigation info in _config.yml -->
      
         <!-- don't show current page in menu -->
        <a class="text-sm text-gray-500 hover:text-gray-900 px-3 py-2 lg:py-1 mx-auto uppercase"
          href="/blog/about">
          About
        </a>
        
      
         <!-- don't show current page in menu -->
        <a class="text-sm text-gray-500 hover:text-gray-900 px-3 py-2 lg:py-1 mx-auto uppercase"
          href="/blog/category">
          Category
        </a>
        
      
    </div>
    </div>
  </div>
</nav>
        <div id="sidebar" class="p-4 fixed"></div>
      
      <div class="px-4 pt-4 prose prose-indigo">
  <h1 class="text-center mt-6 mb-6">(Git_7) Private Information, Remove a File in Git, Commit in other branch, Github</h1>
  <div class="text-center">
    
  </div>
  <div class="px-72">
    <h2 id="remove-private-information">Remove Private Information</h2>

<p><strong>After removing the private information from a file</strong> such that</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>password: 123
</code></pre></div></div>
<p>to</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>password: ENV["password"]
</code></pre></div></div>
<p>there are two method to solve this problem.</p>
<h3 id="first-method-delete-wholegitfile">First Method: delete whole .git file</h3>

<p>Although this method discard the whole history, it still works</p>

<h3 id="second-method-filter-branch">Second Method: filter-branch</h3>

<p>For example, if the private information exists in aaa.txt. We can</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git filter-branch --tree-filter "rm aaa.txt" HEAD
</code></pre></div></div>
<p>and then we can save this file with correct information again and commit it again. 
This command will remove all the aaa.txt file in each commit and the sha1 saved in refs in .git</p>

<p>If we regret the filter-branch process, we can use</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git reset refs/original/refs/heads/master --hard
</code></pre></div></div>
<p>It will recover the sha1 value before filter-branch</p>

<h3 id="how-to-truly-remove-a-file-fromgit">How to truly remove a file from git</h3>

<p>After filter-branch, we still can use refs to recover the file, so</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rm .git/refs/original/refs/heads/master
</code></pre></div></div>
<p>It removes this file, so that we cannot recover from it.</p>

<p>Then delete reflog, which stores all the commits sha-1 states</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git reflog expire --all --expire=now
</code></pre></div></div>
<p>The above code advances the expire date to now</p>

<p>Then delete all deleted commits with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git gc --prune=now
</code></pre></div></div>
<p>Check any miscellaneous</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git fsck
</code></pre></div></div>
<p>If empty, then we are done</p>

<h1 id="to-be-continued">to be continued</h1>

<h3 id="what-if-we-want-commit-in-otherbranch">What if we want commit in other branch</h3>

<p>Given there are two branches, master and second, as follow</p>

<p><img src="/Users/chenyongzhe/coding/practice_not_for_github/javascript_practice/medium-to-markdown/medium-export/posts/md_1623056197395/img/1__ho8PO4iiDP9crllA__GvLdg.png" alt="" />
<img src="/Users/chenyongzhe/coding/practice_not_for_github/javascript_practice/medium-to-markdown/medium-export/posts/md_1623056197395/img/1__MQZVe8jzapH__gUXmxAv0__A.png" alt="" /></p>

<p>If we want to copy <code class="language-plaintext highlighter-rouge">217e18e</code> in second branch upon<code class="language-plaintext highlighter-rouge">7311241</code> in master, then in master branch, cherry-pick <code class="language-plaintext highlighter-rouge">217e18e</code></p>

<p>$ git cherry-pick 217e18e</p>

<p>and the commits in master</p>

<p><img src="/Users/chenyongzhe/coding/practice_not_for_github/javascript_practice/medium-to-markdown/medium-export/posts/md_1623056197395/img/1__x9aVsG4aqMcGxgsJezL8wg.png" alt="" /></p>

<h3 id="reference">Reference:</h3>

<p><a href="https://gitbook.tw/chapters/introduction/what-is-git.html" title="https://gitbook.tw/chapters/introduction/what-is-git.html"><strong>什麼是 Git？為什麼要學習它?</strong></a></p>

  </div>
</div>

<footer class="relative px-4 pt-4 pb-4">
  
  <!-- divider -->
  <div class="relative my-8">
    <div class="absolute inset-0 flex items-center" aria-hidden="true">
      <div class="w-full border-t border-gray-200"></div>
    </div>
    <div class="relative flex justify-center ">
      <span class="bg-white px-2 text-gray-200">
        <i class="text-xs far fa-square"></i>
      </span>
    </div>
  </div>

  <!-- footer msg -->
  <div class="flex flex-wrap items-center justify-center">
    <div class="text-sm text-gray-300">
      © <span id="get-current-year"></span>
      
      <a href="" class="!no-underline">
        
      </a>
      
    </div>
  </div>
  </div>
</footer>

<script type="text/javascript" src="/assets/javascripts/bundle.js" charset="utf-8"></script>

    </div>
  </body>

  <script>
    /* Funtion for getting the current year in the footer */
    (function () {
      if (document.getElementById("get-current-year")) {
        document.getElementById(
          "get-current-year"
        ).innerHTML = new Date().getFullYear();
      }
    })();

    /* Function for opning navbar on mobile */
    function toggleNavbar(collapseID) {
        document.getElementById(collapseID).classList.toggle("hidden");
        document.getElementById(collapseID).classList.toggle("block");
      }
      /* Function for dropdowns */
      function openDropdown(event, dropdownID) {
        let element = event.target;
        while (element.nodeName !== "A") {
          element = element.parentNode;
        }
        document.getElementById(dropdownID).classList.toggle("hidden");
        document.getElementById(dropdownID).classList.toggle("block");
      }
  </script>
</html>
