---
layout: post
title:
description: ''
date: '2022-08-12'
categories: database
note:
mathjax:
mermaid:
p5:
threeJS:
anchor:
publish: true
---

## Introduction

Keep in mind that we want server side to prepare data as quick as possible. N+1 query problem happens when there are N queries depends on 1 query; for example, given model relation that user has many blog posts. If we want to retrieve all the posts of a specific user, a SQL command looks like

```SQL
SELECT "users".* FROM "users" WHERE "users"."id" IN (?, ?, ?, ?, ?)  [["id", 2], ["id", 4]]
```

```SQL
SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?  [["id", 2], ["LIMIT", 1]]
SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?  [["id", 2], ["LIMIT", 1]]
SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?  [["id", 4], ["LIMIT", 1]]
SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?  [["id", 4], ["LIMIT", 1]]
SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?  [["id", 4], ["LIMIT", 1]]
SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?  [["id", 4], ["LIMIT", 1]]
```

instead of

```SQL
SELECT "users".* FROM "users" WHERE "users"."id" IN (?, ?, ?, ?, ?)  [["id", 2], ["id", 4]]
```

## Why?

focus on why we need it

## How?

focus on the mechanim

## What?

In rails, we solve it with

## Reference

[Understanding and fixing N+1 query](https://medium.com/doctolib/understanding-and-fixing-n-1-query-30623109fe89)
